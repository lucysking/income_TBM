{
    "collab_server" : "",
    "contents" : "---\ntitle: \"Effects of Deprivation on Brain Structure\"\nauthor: \"Lucy King\"\noutput: html_notebook\n---\n\nThis script to probe sex*income-to-needs interactions predicted TBM data at T1 of the ELS study. Voxel-wise statistics will be used, but regressions here can quantify variance explained by the interaction and within boys only (R^2). Further, ggplot visualizations will be used in the manuscript.\n\nFirst run script \"threat_deprivation\" to calculate income-to-needs. \n\n*Read data*\n```{r read_data}\nlibrary(dplyr)\nlibrary(forcats)\nlibrary(ggplot2)\n\n#create theme for plotting\nnumber_ticks <- function(n) {function(limits) pretty(limits, n)}\ndepthrt_theme <- theme_bw()+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), axis.title.y = element_text(size = 30), axis.title.x = element_text(size = 30), axis.text.x = element_text(size = 24), axis.text.y = element_text(size = 24), legend.title = element_text(size = 30), legend.text = element_text(size = 24))\n\n#read amd merge files for ROIs significant in interactions\nroi_inc_int <- read.csv(\"~/Desktop/ELS/dep_thrt_TBM/data/Inc_Interac_ROIs.csv\", header = T)\nroi_inc_int <- merge(roi_inc_int, dep_thrt[, c(\"ELS_ID\", \"income_needs\")], by = \"ELS_ID\")\n\n#apply names to sex factor variable\nroi_inc_int$Sex<- as.factor(roi_inc_int$Male)\nroi_inc_int <- roi_inc_int %>% mutate(Sex = fct_recode(Sex, \"Female\" = \"0\", \"Male\" = \"1\"))\n\n#read amd merge files for ROIs significant in boys only\nroi_inc_boys <- read.csv(\"~/Desktop/ELS/dep_thrt_TBM/data/boysonly_inc_ROIs.csv\", header = T)\nroi_inc <- merge(roi_inc_int, roi_inc_boys, by = \"ELS_ID\", all = T)\n\n#read amd merge files for ROIs significant in boys only\nroi_inc_girls <- read.csv(\"~/Desktop/ELS/dep_thrt_TBM/data/girlsonly_inc_ROIs.csv\", header = T)\nroi_inc <- merge(roi_inc, roi_inc_girls, by = \"ELS_ID\", all = T)\n\n#N low-income in subset with brain data\nroi_inc$low_inc <- ifelse(roi_inc$income_needs<1, \"low\", \"higher\")\ntable(roi_inc$low_inc)\nprop.table(table(roi_inc$low_inc))\n\nroi_inc <- subset(roi_inc, !is.na(ICV))\n```\n\n###ROIs Significant in Voxel-Wise Interactions\n\n## Plot Left Hippocampus\n```{r plot_Lhipp}\n#obtain residuals for plotting\nhipp_resid <- lm(L_Hipp ~ Sex + ICV + Tanner + Age + White, data = roi_inc)\nroi_inc$L_Hipp_resid <- residuals(hipp_resid)\n\n#linear\nggplot(roi_inc, aes(x = income_needs, y = L_Hipp_resid, group = Sex)) +\n  geom_point(size =2,aes(color = Sex)) +\n  geom_smooth(method = \"lm\", se = FALSE, size =2,  aes(color = Sex))\n\n#square root\npng(filename=\"~/Desktop/ELS/dep_thrt_TBM/depthrt_sync/plots/incsex_LHipp.png\", width = 700, height = 600)\nggplot(roi_inc, aes(x = income_needs, y = L_Hipp_resid, group = Sex)) +\n  geom_point(size =2,aes(color = Sex)) +\n  geom_smooth(method = \"lm\", se = FALSE, size =2,  formula = y ~ I(sqrt(x)), aes(color = Sex)) +\n  depthrt_theme +\n  xlab(\"Income-to-Needs\") +\n  ylab(\"Left Hippocampus\")\ndev.off()\n\n#log\nggplot(roi_inc, aes(x = income_needs, y = L_Hipp_resid, group = Sex)) +\n  geom_point(size =2,aes(color = Sex)) +\n  geom_smooth(method = \"lm\", se = FALSE, size =2,  formula = y ~ I(log(x)), aes(color = Sex))\n\n\n```\n\n## Test Interactions: Left Hippocampus\n```{r hipp_int_income}\n#no interaction\ninc_hipp0 <- lm(L_Hipp ~ income_needs + Sex + ICV + Tanner + Age + White, data = roi_inc)\nsummary(inc_hipp0)\n\n#linear\ninc_hipp1 <- lm(L_Hipp ~ income_needs * Sex + ICV + Tanner + Age + White, data = roi_inc)\nsummary(inc_hipp1)\nAIC(inc_hipp1)\nBIC(inc_hipp1)\n\n#square-root\ncontrasts(roi_inc$Sex) = c(0, 1) #simple effect for female\ninc_hipp2_f <- lm(L_Hipp ~ I(sqrt(income_needs)) * Sex + ICV + Tanner + Age + White, data = roi_inc)\nsummary(inc_hipp2_f)\nAIC(inc_hipp2_f)\nBIC(inc_hipp2_f)\n\ncontrasts(roi_inc$Sex) = c(1, 0) #simple effect for male\ninc_hipp2_m <- lm(L_Hipp ~ I(sqrt(income_needs)) * Sex + ICV + Tanner + Age + White, data = roi_inc)\nsummary(inc_hipp2_m)\n\n#log\ninc_hipp3 <- lm(L_Hipp ~ I(log(income_needs)) * Sex + ICV + Tanner + Age + White, data = roi_inc)\nsummary(inc_hipp3)\nAIC(inc_hipp3)\nBIC(inc_hipp3)\n```\nRoughly equal fit across models, although variance explained by the interaction is higher for square-root and log-transformed models. The interaction explains approx. 8% of the variance in left hippocampal voulme. \n\nAmong females, increases in income are significantly associated with increases in the left hippocampus. Among males, increases in income are significantly associated with decreases in the left hippocampus.\n\n## Plot Right Hippocampus\n```{r plot_Rhipp}\n#obtain residuals for plotting\nR_Hipp_resid <- lm(R_Hipp ~ Sex + ICV + Tanner + Age + White, data = roi_inc)\nroi_inc$R_Hipp_resid <- residuals(R_Hipp_resid)\n\n#linear\nggplot(roi_inc, aes(x = income_needs, y = R_Hipp_resid, group = Sex)) +\n  geom_point(size =2,aes(color = Sex)) +\n  geom_smooth(method = \"lm\", se = FALSE, size =2,  aes(color = Sex))\n\n#square root\npng(filename=\"~/Desktop/ELS/dep_thrt_TBM/depthrt_sync/plots/incsex_RHipp.png\", width = 700, height = 600)\nggplot(roi_inc, aes(x = income_needs, y = R_Hipp_resid, group = Sex)) +\n  geom_point(size =2,aes(color = Sex)) +\n  geom_smooth(method = \"lm\", se = FALSE, size =2,  formula = y ~ I(sqrt(x)), aes(color = Sex)) +\n  depthrt_theme +\n  xlab(\"Income-to-Needs\") +\n  ylab(\"Right Hippocampus\")\ndev.off()\n\n#log\nggplot(roi_inc, aes(x = income_needs, y = R_Hipp_resid, group = Sex)) +\n  geom_point(size =2,aes(color = Sex)) +\n  geom_smooth(method = \"lm\", se = FALSE, size =2,  formula = y ~ I(log(x)), aes(color = Sex))\n```\n\n## Test Interactions: Right Hippocampus\n```{r Rhipp_int_income}\n#no interaction\ninc_RHipp0 <- lm(R_Hipp~ income_needs + Sex + ICV + Tanner + Age + White, data = roi_inc)\nsummary(inc_RHipp0)\n\n#linear\ninc_RHipp1 <- lm(R_Hipp~ income_needs * Sex + ICV + Tanner + Age + White, data = roi_inc)\nsummary(inc_RHipp1)\nAIC(inc_RHipp1)\nBIC(inc_RHipp1)\n\n#square-root\ncontrasts(roi_inc$Sex) = c(0, 1) #simple effect for female\ninc_RHipp2_f <- lm(R_Hipp ~ I(sqrt(income_needs)) * Sex + ICV + Tanner + Age + White, data = roi_inc)\nsummary(inc_RHipp2_f)\nAIC(inc_RHipp2_f)\nBIC(inc_RHipp2_f)\n\ncontrasts(roi_inc$Sex) = c(1, 0) #simple effect for male\ninc_RHipp2_m <- lm(R_Hipp ~ I(sqrt(income_needs)) * Sex + ICV + Tanner + Age + White, data = roi_inc)\nsummary(inc_RHipp2_m)\n\n#log\ninc_RHipp3 <- lm(R_Hipp~ I(log(income_needs)) * Sex + ICV + Tanner + Age + White, data = roi_inc)\nsummary(inc_RHipp3)\nAIC(inc_RHipp3)\nBIC(inc_RHipp3)\n\n\n```\nLog-transformed model worse fit for data and explains considerably less variance. In linear and square-root models, model fit is similar and interaction explains aprox. 9% of variance.\n\nAmong females, increases in income significantly associated with increases in right hippocampal volume. Among males, increases in income significantly associated with decreases in right hippocampal volume.\n\n```{r plot_BiHipp}\nroi_inc$Bi_Hipp <- roi_inc$L_Hipp + roi_inc$R_Hipp\n\n#obtain residuals for plotting\nBi_Hipp_resid <- lm(Bi_Hipp ~ Sex + ICV + Tanner + Age + White, data = roi_inc)\nroi_inc$Bi_Hipp_resid <- residuals(Bi_Hipp_resid)\n\njpeg(filename=\"~/Desktop/ELS/dep_thrt_TBM/depthrt_sync/plots/inc_BiHipp.jpg\", width = 700, height = 600)\nggplot(data=roi_inc, aes(x=income_needs, y=Bi_Hipp_resid, group = Sex)) +\n  geom_point(size = 4, alpha = 6/10, aes (color= Sex)) +\n  geom_smooth(method = \"lm\", se = T, formula = y ~ sqrt(x), size =3, aes(color = Sex, fill = Sex)) +\n  depthrt_theme +\n  scale_color_manual(values=c(\"goldenrod3\",\"cyan4\")) +\n  scale_fill_manual(values=c(\"darkgoldenrod3\", \"darkcyan\")) +\n  ylab(\"Bilateral hippocampus\") +\n  xlab(\"Income-to-needs\")\n```\n\n\n## Plot Cerebellar Vermis\n```{r plot_vermis}\n#obtain residuals for plotting\nCV_resid <- lm(C_Vermis ~ Sex + ICV + Tanner + Age + White, data = roi_inc)\nroi_inc$CV_resid <- residuals(CV_resid)\n\n#linear\nggplot(roi_inc, aes(x = income_needs, y = CV_resid, group = Sex)) +\n  geom_point(size =2,aes(color = Sex)) +\n  geom_smooth(method = \"lm\", se = FALSE, size =2,  aes(color = Sex))\n\n#square root\njpeg(filename=\"~/Desktop/ELS/dep_thrt_TBM/depthrt_sync/plots/inc_CV.jpg\", width = 700, height = 600)\nggplot(data=roi_inc, aes(x=income_needs, y=CV_resid, group = Sex)) +\n  geom_point(size = 4, alpha = 6/10, aes (color= Sex)) +\n  geom_smooth(method = \"lm\", se = T, formula = y ~ sqrt(x), size =3, aes(color = Sex, fill = Sex)) +\n  depthrt_theme +\n  scale_color_manual(values=c(\"goldenrod3\",\"cyan4\")) +\n  scale_fill_manual(values=c(\"darkgoldenrod3\", \"darkcyan\")) +\n  ylab(\"Cerebellar vermis\") +\n  xlab(\"Income-to-needs\")\n\n#log\nggplot(roi_inc, aes(x = income_needs, y = CV_resid, group = Sex)) +\n  geom_point(size =2,aes(color = Sex)) +\n  geom_smooth(method = \"lm\", se = FALSE, size =2,  formula = y ~ I(log(x)), aes(color = Sex))\n```\n\n## Test Interaction: Cerebellar Vermis\n```{r CV_int_income}\n#no interaction\ninc_CV0 <- lm(C_Vermis~ income_needs + Sex + ICV + Tanner + Age + White, data = roi_inc)\nsummary(inc_CV0)\nAIC(inc_CV0)\nBIC(inc_CV0)\n\n#linear\ninc_CV1 <- lm(C_Vermis~ income_needs * Sex + ICV + Tanner + Age + White, data = roi_inc)\nsummary(inc_CV1)\nAIC(inc_CV1)\nBIC(inc_CV1)\n\n#square-root\ncontrasts(roi_inc$Sex) = c(0, 1) #simple effect for female\ninc_CV2_f <- lm(C_Vermis ~ I(sqrt(income_needs)) * Sex + ICV + Tanner + Age + White, data = roi_inc)\nsummary(inc_CV2_f)\nAIC(inc_CV2_f)\nBIC(inc_CV2_f)\n\ncontrasts(roi_inc$Sex) = c(1, 0) #simple effect for male\ninc_CV2_m <- lm(C_Vermis ~ I(sqrt(income_needs)) * Sex + ICV + Tanner + Age + White, data = roi_inc)\nsummary(inc_CV2_m)\n\n#log\ninc_CV3 <- lm(C_Vermis ~ I(log(income_needs)) * Sex + ICV + Tanner + Age + White, data = roi_inc)\nsummary(inc_CV3)\nAIC(inc_CV3)\nBIC(inc_CV3)\n```\nRoughly equal fit across models, although variance explained by the interaction is highest in log-transformed model (aprox. 9%).\n\nAmong females, increases in income are significantly associated with decreases in cerebellar vermis volume. Among males, increases in income are significantly associated with increases in cerebellar vermis volume. \n\n## Plot IFOF\n```{r plot_IFOF}\n#obtain residuals for plotting\nIFOF_resid <- lm(IFOF ~ Sex + ICV + Tanner + Age + White, data = roi_inc)\nroi_inc$IFOF_resid <- residuals(IFOF_resid)\n\n#linear\nggplot(roi_inc, aes(x = income_needs, y = IFOF_resid, group = Sex)) +\n  geom_point(size =2,aes(color = Sex)) +\n  geom_smooth(method = \"lm\", se = FALSE, size =2,  aes(color = Sex))\n\n#square root\npng(filename=\"~/Desktop/ELS/dep_thrt_TBM/depthrt_sync/plots/incsex_IFOF.png\", width = 700, height = 600)\nggplot(roi_inc, aes(x = income_needs, y = IFOF_resid, group = Sex)) +\n  geom_point(size =2,aes(color = Sex)) +\n  geom_smooth(method = \"lm\", se = FALSE, size =2,  formula = y ~ I(sqrt(x)), aes(color = Sex)) +\n  depthrt_theme +\n  xlab(\"Income-to-Needs\") +\n  ylab(\"IFOF\")\ndev.off()\n\n#log\nggplot(roi_inc, aes(x = income_needs, y = IFOF_resid, group = Sex)) +\n  geom_point(size =2,aes(color = Sex)) +\n  geom_smooth(method = \"lm\", se = FALSE, size =2,  formula = y ~ I(log(x)), aes(color = Sex))\n```\n\n## Test Interactions: IFOF\n```{r IFOF_int_income}\n#no interaction\ninc_IFOF0 <- lm(IFOF~ income_needs + Sex + ICV + Tanner + Age + White, data = roi_inc)\nsummary(inc_IFOF0)\n\n#linear\ninc_IFOF1 <- lm(IFOF~ income_needs * Sex + ICV + Tanner + Age + White, data = roi_inc)\nsummary(inc_IFOF1)\nAIC(inc_IFOF1)\nBIC(inc_IFOF1)\n\n#square-root\ncontrasts(roi_inc$Sex) = c(0, 1) #simple effect for female\ninc_IFOF2_f <- lm(IFOF ~ I(sqrt(income_needs)) * Sex + ICV + Tanner + Age + White, data = roi_inc)\nsummary(inc_IFOF2_f)\nAIC(inc_IFOF2_f)\nBIC(inc_IFOF2_f)\n\ncontrasts(roi_inc$Sex) = c(1, 0) #simple effect for male\ninc_IFOF2_m <- lm(IFOF ~ I(sqrt(income_needs)) * Sex + ICV + Tanner + Age + White, data = roi_inc)\nsummary(inc_IFOF2_m)\n\n#log\ninc_IFOF3 <- lm(IFOF ~ I(log(income_needs)) * Sex + ICV + Tanner + Age + White, data = roi_inc)\nsummary(inc_IFOF3)\nAIC(inc_IFOF3)\nBIC(inc_IFOF3)\n```\nRoughly equal fit and explained variance across models. Interaction explains aprox. 6% of variance. \n\nAmong females, income is not significantly associated with IFOF volume. Among males, increases in income are significantly associated with decreases in IFOF volume.\n\n## Plot Left MTG\n```{r plot_MTG}\n#obtain residuals for plotting\nL_MTG_resid <- lm(L_MTG ~ Sex + ICV + Tanner + Age + White, data = roi_inc)\nroi_inc$L_MTG_resid <- residuals(L_MTG_resid)\n\n#linear\nggplot(roi_inc, aes(x = income_needs, y = L_MTG_resid, group = Sex)) +\n  geom_point(size =2,aes(color = Sex)) +\n  geom_smooth(method = \"lm\", se = FALSE, size =2,  aes(color = Sex))\n\n#square root\npng(filename=\"~/Desktop/ELS/dep_thrt_TBM/depthrt_sync/plots/incsex_MTG.png\", width = 700, height = 600)\nggplot(roi_inc, aes(x = income_needs, y = L_MTG_resid, group = Sex)) +\n  geom_point(size =2,aes(color = Sex)) +\n  geom_smooth(method = \"lm\", se = FALSE, size =2,  formula = y ~ I(sqrt(x)), aes(color = Sex)) +\n  depthrt_theme +\n  xlab(\"Income-to-Needs\") +\n  ylab(\"Left MTG\")\ndev.off()\n\n\n#log\nggplot(roi_inc, aes(x = income_needs, y = L_MTG_resid, group = Sex)) +\n  geom_point(size =2,aes(color = Sex)) +\n  geom_smooth(method = \"lm\", se = FALSE, size =2,  formula = y ~ I(log(x)), aes(color = Sex))\n```\n\n## Test Interactions: MTG\n```{r MTG_int_income}\n#no interaction\ninc_MTG0 <- lm(L_MTG~ income_needs + Sex + ICV + Tanner + Age + White, data = roi_inc)\nsummary(inc_MTG0)\n\n#linear\ninc_MTG1 <- lm(L_MTG~ income_needs * Sex + ICV + Tanner + Age + White, data = roi_inc)\nsummary(inc_MTG1)\nAIC(inc_MTG1)\nBIC(inc_MTG1)\n\n#square-root\ncontrasts(roi_inc$Sex) = c(0, 1) #simple effect for female\ninc_MTG2_f <- lm(L_MTG ~ I(sqrt(income_needs)) * Sex + ICV + Tanner + Age + White, data = roi_inc)\nsummary(inc_MTG2_f)\nAIC(inc_MTG2_f)\nBIC(inc_MTG2_f)\n\ncontrasts(roi_inc$Sex) = c(1, 0) #simple effect for male\ninc_MTG2_m <- lm(L_MTG ~ I(sqrt(income_needs)) * Sex + ICV + Tanner + Age + White, data = roi_inc)\nsummary(inc_MTG2_m)\n\n#log\ninc_MTG3 <- lm(L_MTG ~ I(log(income_needs)) * Sex + ICV + Tanner + Age + White, data = roi_inc)\nsummary(inc_MTG3)\nAIC(inc_MTG3)\nBIC(inc_MTG3)\n```\nRoughly equal fit across models, although square-root and log-transformed models explain more variance. Interaction for square-root transformed model explains aprox. 12% of variance. \n\nAmong females, increases in income significantly associated with increases in MTG volume. Among males, increases income significantly associated with decreases in MTG volume.\n\n## Plot Lateral OFC\n```{r plot_OFC}\n#obtain residuals for plotting\nL_OFC_resid <- lm(L_OFC ~ Sex + ICV + Tanner + Age + White, data = roi_inc)\nroi_inc$L_OFC_resid <- residuals(L_OFC_resid)\n\n#linear\nggplot(roi_inc, aes(x = income_needs, y = L_OFC_resid, group = Sex)) +\n  geom_point(size =2,aes(color = Sex)) +\n  geom_smooth(method = \"lm\", se = FALSE, size =2,  aes(color = Sex))\n\n#square root\njpeg(filename=\"~/Desktop/ELS/dep_thrt_TBM/depthrt_sync/plots/inc_ofc.jpg\", width = 700, height = 600)\nggplot(data=roi_inc, aes(x=income_needs, y=L_OFC_resid, group = Sex)) +\n  geom_point(size = 4, alpha = 6/10, aes (color= Sex)) +\n  geom_smooth(method = \"lm\", se = T, formula = y ~ sqrt(x), size =3, aes(color = Sex, fill = Sex)) +\n  depthrt_theme +\n  scale_color_manual(values=c(\"goldenrod3\",\"cyan4\")) +\n  scale_fill_manual(values=c(\"darkgoldenrod3\", \"darkcyan\")) +\n  ylab(\"Right lateral OFC\") +\n  xlab(\"Income-to-needs\")\n\n#log\nggplot(roi_inc, aes(x = income_needs, y = L_OFC_resid, group = Sex)) +\n  geom_point(size =2,aes(color = Sex)) +\n  geom_smooth(method = \"lm\", se = FALSE, size =2,  formula = y ~ I(log(x)), aes(color = Sex))\n```\n\n## Test Interactions: OFC\n```{r OFC_int_income}\n#no interaction\ninc_OFC0 <- lm(L_OFC ~ income_needs + Sex + ICV + Tanner + Age + White, data = roi_inc)\nsummary(inc_OFC0)\n\n#linear \ninc_OFC1 <- lm(L_OFC~ income_needs * Sex + ICV + Tanner + Age + White, data = roi_inc)\nsummary(inc_OFC1)\nAIC(inc_OFC1)\nBIC(inc_OFC1)\n\n#square-root\ncontrasts(roi_inc$Sex) = c(0, 1) #simple effect for female\ninc_OFC2_f <- lm(L_OFC ~ I(sqrt(income_needs)) * Sex + ICV + Tanner + Age + White, data = roi_inc)\nsummary(inc_OFC2_f)\nAIC(inc_OFC2_f)\nBIC(inc_OFC2_f)\n\ncontrasts(roi_inc$Sex) = c(1, 0) #simple effect for male\ninc_OFC2_m <- lm(L_OFC ~ I(sqrt(income_needs)) * Sex + ICV + Tanner + Age + White, data = roi_inc)\nsummary(inc_OFC2_m)\n\n#log\ninc_OFC3 <- lm(L_OFC ~ I(log(income_needs)) * Sex + ICV + Tanner + Age + White, data = roi_inc)\nsummary(inc_OFC3)\nAIC(inc_OFC3)\nBIC(inc_OFC3)\n```\nRoughly equal fit across models. Interaction explains aprox. 5% of the variance. \n\nAmong females, increases in income significantly associated with decreases in left OFC volume. Among males, increases in income significantly associated with increases in left OFC volume.\n\n## Plot Left Thalamus\n```{r plot_Lthalamus}\n#obtain residuals for plotting\nL_Thalamus_resid <- lm(L_Thalamus ~ Sex + ICV + Tanner + Age + White, data = roi_inc)\nroi_inc$L_Thalamus_resid <- residuals(L_Thalamus_resid)\n\n#linear\nggplot(roi_inc, aes(x = income_needs, y = L_Thalamus_resid, group = Sex)) +\n  geom_point(size =2,aes(color = Sex)) +\n  geom_smooth(method = \"lm\", se = FALSE, size =2,  aes(color = Sex))\n\n#square root\nggplot(roi_inc, aes(x = income_needs, y = L_Thalamus_resid, group = Sex)) +\n  geom_point(size =2,aes(color = Sex)) +\n  geom_smooth(method = \"lm\", se = FALSE, size =2,  formula = y ~ I(sqrt(x)), aes(color = Sex))\n\n#log\nggplot(roi_inc, aes(x = income_needs, y = L_Thalamus_resid, group = Sex)) +\n  geom_point(size =2,aes(color = Sex)) +\n  geom_smooth(method = \"lm\", se = FALSE, size =2,  formula = y ~ I(log(x)), aes(color = Sex))\n```\n\n## Test Interactions: Left Thalamus\n```{r Lthalamus_int_income}\n#no interaction\ninc_Thal0 <- lm(L_Thalamus~ income_needs + Sex + ICV + Tanner + Age + White, data = roi_inc)\nsummary(inc_OFC0)\n\n#linear\ninc_Thal1 <- lm(L_Thalamus~ income_needs * Sex + ICV + Tanner + Age + White, data = roi_inc)\nsummary(inc_Thal1)\nAIC(inc_Thal1)\nBIC(inc_Thal1)\n\n#square-root\ncontrasts(roi_inc$Sex) = c(0, 1) #simple effect for female\ninc_Thal2_f <- lm(L_Thalamus ~ I(sqrt(income_needs)) * Sex + ICV + Tanner + Age + White, data = roi_inc)\nsummary(inc_Thal2_f)\nAIC(inc_Thal2_f)\nBIC(inc_Thal2_f)\n\ncontrasts(roi_inc$Sex) = c(1, 0) #simple effect for male\ninc_Thal2_m <- lm(L_Thalamus ~ I(sqrt(income_needs)) * Sex + ICV + Tanner + Age + White, data = roi_inc)\nsummary(inc_Thal2_m)\n\n#log\ninc_Thal3 <- lm(L_Thalamus ~ I(log(income_needs)) * Sex + ICV + Tanner + Age + White, data = roi_inc)\nsummary(inc_Thal3)\nAIC(inc_Thal3)\nBIC(inc_Thal3)\n```\nRoughly equal fit across models. Interaction explains aprox. 8% of variance. \n\nAmong females, increases in income significantly associated with increases in left thalamus volume. Among males, increases in income significantly associated with decreases in left thalamus. \n\n\n## Plot Right Thalamus\n```{r plot_Rthalamus}\n#obtain residuals for plotting\nR_Thalamus_resid <- lm(R_Thalamus ~ Sex + ICV + Tanner + Age + White, data = roi_inc)\nroi_inc$R_Thalamus_resid <- residuals(R_Thalamus_resid)\n\n#linear\nggplot(roi_inc, aes(x = income_needs, y = R_Thalamus_resid, group = Sex)) +\n  geom_point(size =2,aes(color = Sex)) +\n  geom_smooth(method = \"lm\", se = FALSE, size =2,  aes(color = Sex))\n\n#square root\nggplot(roi_inc, aes(x = income_needs, y = R_Thalamus_resid, group = Sex)) +\n  geom_point(size =2,aes(color = Sex)) +\n  geom_smooth(method = \"lm\", se = FALSE, size =2,  formula = y ~ I(sqrt(x)), aes(color = Sex))\n\n#log\nggplot(roi_inc, aes(x = income_needs, y = R_Thalamus_resid, group = Sex)) +\n  geom_point(size =2,aes(color = Sex)) +\n  geom_smooth(method = \"lm\", se = FALSE, size =2,  formula = y ~ I(log(x)), aes(color = Sex))\n\n#average right and left thalamus\nroi_inc$Bi_Thalamus <- (roi_inc$R_Thalamus + roi_inc$L_Thalamus)/2\n#obtain bilateral residuals for plotting\nBi_Thalamus_resid <- lm(Bi_Thalamus ~ Sex + ICV + Tanner + Age + White, data = roi_inc)\nroi_inc$Bi_Thalamus_resid <- residuals(Bi_Thalamus_resid)\n\n#square root, bilateral thalamus\npng(filename=\"~/Desktop/ELS/dep_thrt_TBM/depthrt_sync/plots/incsex_Thal.png\", width = 700, height = 600)\nggplot(roi_inc, aes(x = income_needs, y = Bi_Thalamus_resid, group = Sex)) +\n  geom_point(size =2,aes(color = Sex)) +\n  geom_smooth(method = \"lm\", se = FALSE, size =2,  formula = y ~ I(sqrt(x)), aes(color = Sex)) +\n  depthrt_theme +\n  xlab(\"Income-to-Needs\") +\n  ylab(\"Bilateral Thalamus\")\ndev.off()\n\n```\n\n## Test Interactions: Right Thalamus\n```{r thalamus_int_income}\n#no interaction\ninc_RThal0 <- lm(R_Thalamus~ income_needs + Sex + ICV + Tanner + Age + White, data = roi_inc)\nsummary(inc_RThal0)\n\n#linear\ninc_RThal1 <- lm(R_Thalamus~ income_needs * Sex + ICV + Tanner + Age + White, data = roi_inc)\nsummary(inc_RThal1)\nAIC(inc_RThal1)\nBIC(inc_RThal1)\n\n#square-root\ncontrasts(roi_inc$Sex) = c(0, 1) #simple effect for female\ninc_RThal2_f <- lm(R_Thalamus ~ I(sqrt(income_needs)) * Sex + ICV + Tanner + Age + White, data = roi_inc)\nsummary(inc_RThal2_f)\nAIC(inc_RThal2_f)\nBIC(inc_RThal2_f)\n\ncontrasts(roi_inc$Sex) = c(1, 0) #simple effect for male\ninc_RThal2_m <- lm(R_Thalamus ~ I(sqrt(income_needs)) * Sex + ICV + Tanner + Age + White, data = roi_inc)\nsummary(inc_RThal2_m)\n\n#log\ninc_RThal3 <- lm(R_Thalamus ~ I(log(income_needs)) * Sex + ICV + Tanner + Age + White, data = roi_inc)\nsummary(inc_RThal3)\nAIC(inc_RThal3)\nBIC(inc_RThal3)\n```\n\n## Plot Right Putamen\n```{r plot_putamen}\n#obtain residuals for plotting\nR_Putamen_resid <- lm(R_Putamen ~ Sex + ICV + Tanner + Age + White, data = roi_inc)\nroi_inc$R_Putamen_resid <- residuals(R_Putamen_resid)\n\n#linear\nggplot(roi_inc, aes(x = income_needs, y = R_Putamen_resid, group = Sex)) +\n  geom_point(size =2,aes(color = Sex)) +\n  geom_smooth(method = \"lm\", se = FALSE, size =2,  aes(color = Sex))\n\n#square root\njpeg(filename=\"~/Desktop/ELS/dep_thrt_TBM/depthrt_sync/plots/inc_put.jpg\", width = 700, height = 600)\nggplot(data=roi_inc, aes(x=income_needs, y=R_Putamen_resid, group = Sex)) +\n  geom_point(size = 4, alpha = 6/10, aes (color= Sex)) +\n  geom_smooth(method = \"lm\", se = T, formula = y ~ sqrt(x), size =3, aes(color = Sex, fill = Sex)) +\n  depthrt_theme +\n  scale_color_manual(values=c(\"goldenrod3\",\"cyan4\")) +\n  scale_fill_manual(values=c(\"darkgoldenrod3\", \"darkcyan\")) +\n  ylab(\"Right putamen\") +\n  xlab(\"Income-to-needs\")\n\n#log\nggplot(roi_inc, aes(x = income_needs, y = R_Putamen_resid, group = Sex)) +\n  geom_point(size =2,aes(color = Sex)) +\n  geom_smooth(method = \"lm\", se = FALSE, size =2,  formula = y ~ I(log(x)), aes(color = Sex))\n```\n\n## Test Interactions: Right Putamen\n```{r putamen_int_income}\n#no interaction\ninc_Put0 <- lm(R_Putamen~ income_needs + Sex + ICV + Tanner + Age + White, data = roi_inc)\nsummary(inc_Put0)\n\n#linear\ninc_Put1 <- lm(R_Putamen~ income_needs * Sex + ICV + Tanner + Age + White, data = roi_inc)\nsummary(inc_Put1)\nAIC(inc_Put1)\nBIC(inc_Put1)\n\n#square-root\ncontrasts(roi_inc$Sex) = c(0, 1) #simple effect for female\ninc_Put2_f <- lm(R_Putamen ~ I(sqrt(income_needs)) * Sex + ICV + Tanner + Age + White, data = roi_inc)\nsummary(inc_Put2_f)\nAIC(inc_Put2_f)\nBIC(inc_Put2_f)\n\ncontrasts(roi_inc$Sex) = c(1, 0) #simple effect for male\ninc_Put2_m <- lm(R_Putamen ~ I(sqrt(income_needs)) * Sex + ICV + Tanner + Age + White, data = roi_inc)\nsummary(inc_Put2_m)\n\n#log\ninc_Put3 <- lm(R_Putamen ~ I(log(income_needs)) * Sex + ICV + Tanner + Age + White, data = roi_inc)\nsummary(inc_Put3)\nAIC(inc_Put3)\nBIC(inc_Put3)\n```\n\nRoughly equal fit across models. Interaction explains aprox. 9% of variance. \n\nAmong females, increases in income significantly associated with increases in right putamen volume. Among males, increases in income significantly associated with decreasses in right putamen volume.\n\n\n## Plot Left Uncinate\n```{r plot_uncinate}\n#obtain residuals for plotting\nUncinate_resid <- lm(L_Uncinate ~ Sex + ICV + Tanner + Age + White, data = roi_inc)\nroi_inc$Uncinate_resid <- residuals(Uncinate_resid)\n\n#linear\nggplot(roi_inc, aes(x = income_needs, y = Uncinate_resid, group = Sex)) +\n  geom_point(size =2,aes(color = Sex)) +\n  geom_smooth(method = \"lm\", se = FALSE, size =2,  aes(color = Sex))\n\n#square root\njpeg(filename=\"~/Desktop/ELS/dep_thrt_TBM/depthrt_sync/plots/inc_unc.jpg\", width = 700, height = 600)\nggplot(data=roi_inc, aes(x=income_needs, y=Uncinate_resid, group = Sex)) +\n  geom_point(size = 4, alpha = 6/10, aes (color= Sex)) +\n  geom_smooth(method = \"lm\", se = T, formula = y ~ sqrt(x), size =3, aes(color = Sex, fill = Sex)) +\n  depthrt_theme +\n  scale_color_manual(values=c(\"goldenrod3\",\"cyan4\")) +\n  scale_fill_manual(values=c(\"darkgoldenrod3\", \"darkcyan\")) +\n  ylab(\"Left uncinate\") +\n  xlab(\"Income-to-needs\")\n\n\n#log\nggplot(roi_inc, aes(x = income_needs, y = Uncinate_resid, group = Sex)) +\n  geom_point(size =2,aes(color = Sex)) +\n  geom_smooth(method = \"lm\", se = FALSE, size =2,  formula = y ~ I(log(x)), aes(color = Sex))\n```\n\n## Test Interactions: Left Uncinate\n```{r uncinate_int_income}\n#no interaction\ninc_Unc0 <- lm(L_Uncinate~ income_needs + Sex + ICV + Tanner + Age + White, data = roi_inc)\nsummary(inc_Unc0)\n\n#linear\ninc_Unc1 <- lm(L_Uncinate~ income_needs * Sex + ICV + Tanner + Age + White, data = roi_inc)\nsummary(inc_Unc1)\nAIC(inc_Unc1)\nBIC(inc_Unc1)\n\n#square-root\ncontrasts(roi_inc$Sex) = c(0, 1) #simple effect for female\ninc_Unc2_f <- lm(L_Uncinate ~ I(sqrt(income_needs)) * Sex + ICV + Tanner + Age + White, data = roi_inc)\nsummary(inc_Unc2_f)\nAIC(inc_Unc2_f)\nBIC(inc_Unc2_f)\n\ncontrasts(roi_inc$Sex) = c(1, 0) #simple effect for male\ninc_Unc2_m <- lm(L_Uncinate ~ I(sqrt(income_needs)) * Sex + ICV + Tanner + Age + White, data = roi_inc)\nsummary(inc_Unc2_m)\n\n#log\ninc_Unc3 <- lm(L_Uncinate ~ I(log(income_needs)) * Sex + ICV + Tanner + Age + White, data = roi_inc)\nsummary(inc_Unc3)\nAIC(inc_Unc3)\nBIC(inc_Unc3)\n```\n\nRoughly equal fit across models. Interaction explains aprox. 7% of variance.\n\nAmong females, increases in income are sigficantly associated with increases in left uncinate volume. Among males, increases in income are significantly associated with decreases in left uncinate volume.\n\n\n## Plot Inferior Frontal Gyrus\n```{r plot_IFG_44.33.7}\n#obtain residuals for plotting\nIFG_44.33.7_resid <- lm(IFG_44.33.7 ~ Sex + ICV + Tanner + Age + White, data = roi_inc)\nroi_inc$IFG_44.33.7_resid <- residuals(IFG_44.33.7_resid)\n\n#linear\nggplot(roi_inc, aes(x = income_needs, y = IFG_44.33.7_resid, group = Sex)) +\n  geom_point(size =2,aes(color = Sex)) +\n  geom_smooth(method = \"lm\", se = FALSE, size =2,  aes(color = Sex))\n\n#square root\nggplot(roi_inc, aes(x = income_needs, y = IFG_44.33.7_resid, group = Sex)) +\n  geom_point(size =2,aes(color = Sex)) +\n  geom_smooth(method = \"lm\", se = FALSE, size =2,  formula = y ~ I(sqrt(x)), aes(color = Sex))\n\n#log\nggplot(roi_inc, aes(x = income_needs, y = IFG_44.33.7_resid, group = Sex)) +\n  geom_point(size =2,aes(color = Sex)) +\n  geom_smooth(method = \"lm\", se = FALSE, size =2,  formula = y ~ I(log(x)), aes(color = Sex))\n```\n\n```{r plot_IFG_53.26.13}\n#obtain residuals for plotting\nIFG_53.26.13_resid <- lm(IFG_53.26.13 ~ Sex + ICV + Tanner + Age + White, data = roi_inc)\nroi_inc$IFG_53.26.13_resid <- residuals(IFG_53.26.13_resid)\n\n#linear\nggplot(roi_inc, aes(x = income_needs, y = IFG_53.26.13_resid, group = Sex)) +\n  geom_point(size =2,aes(color = Sex)) +\n  geom_smooth(method = \"lm\", se = FALSE, size =2,  aes(color = Sex))\n\n#square root\nggplot(roi_inc, aes(x = income_needs, y = IFG_53.26.13_resid, group = Sex)) +\n  geom_point(size =2,aes(color = Sex)) +\n  geom_smooth(method = \"lm\", se = FALSE, size =2,  formula = y ~ I(sqrt(x)), aes(color = Sex))\n\n#log\nggplot(roi_inc, aes(x = income_needs, y = IFG_53.26.13_resid, group = Sex)) +\n  geom_point(size =2,aes(color = Sex)) +\n  geom_smooth(method = \"lm\", se = FALSE, size =2,  formula = y ~ I(log(x)), aes(color = Sex))\n```\n\nCoordinates are -56.27.14. Removed - sign for variable name. \n```{r plot_IFG_56.27.14}\n#obtain residuals for plotting\nIFG_56.27.14_resid <- lm(IFG_56.27.14 ~ Sex + ICV + Tanner + Age + White, data = roi_inc)\nroi_inc$IFG_56.27.14_resid <- residuals(IFG_56.27.14_resid)\n\n#linear\nggplot(roi_inc, aes(x = income_needs, y = IFG_56.27.14_resid, group = Sex)) +\n  geom_point(size =2,aes(color = Sex)) +\n  geom_smooth(method = \"lm\", se = FALSE, size =2,  aes(color = Sex))\n\n#square root\nggplot(roi_inc, aes(x = income_needs, y = IFG_56.27.14_resid, group = Sex)) +\n  geom_point(size =2,aes(color = Sex)) +\n  geom_smooth(method = \"lm\", se = FALSE, size =2,  formula = y ~ I(sqrt(x)), aes(color = Sex))\n\n#log\nggplot(roi_inc, aes(x = income_needs, y = IFG_56.27.14_resid, group = Sex)) +\n  geom_point(size =2,aes(color = Sex)) +\n  geom_smooth(method = \"lm\", se = FALSE, size =2,  formula = y ~ I(log(x)), aes(color = Sex))\n```\n\n```{r plot_IFG}\n#combine correlated clusters\nroi_inc$IFG <- roi_inc$IFG_53.26.13 + roi_inc$IFG_56.27.14\n\n#obtain residuals for plotting\nIFG_resid <- lm(IFG ~ Sex + ICV + Tanner + Age + White, data = roi_inc)\nroi_inc$IFG_resid <- residuals(IFG_resid)\n\n#square root\njpeg(filename=\"~/Desktop/ELS/dep_thrt_TBM/depthrt_sync/plots/inc_IFG.jpg\", width = 700, height = 600)\nggplot(data=roi_inc, aes(x=income_needs, y=IFG_resid, group = Sex)) +\n  geom_point(size = 4, alpha = 6/10, aes (color= Sex)) +\n  geom_smooth(method = \"lm\", se = T, formula = y ~ sqrt(x), size =3, aes(color = Sex, fill = Sex)) +\n  depthrt_theme +\n  scale_color_manual(values=c(\"goldenrod3\",\"cyan4\")) +\n  scale_fill_manual(values=c(\"darkgoldenrod3\", \"darkcyan\")) +\n  ylab(\"Inferior frontal gyrus\") +\n  xlab(\"Income-to-needs\")\n```\n\n\n## Test Interactions: Inferior Frontal Gyrus\n```{r IFG_44.33.7_int_income}\n#no interaction\nIFG_44.33.7_0 <- lm(IFG_44.33.7~ income_needs + Sex + ICV + Tanner + Age + White, data = roi_inc)\nsummary(IFG_44.33.7_0)\n\n#linear\nIFG_44.33.7_1 <- lm(IFG_44.33.7~ income_needs * Sex + ICV + Tanner + Age + White, data = roi_inc)\nsummary(IFG_44.33.7_1)\nAIC(IFG_44.33.7_1)\nBIC(IFG_44.33.7_1)\n\n#square-root\ncontrasts(roi_inc$Sex) = c(0, 1) #simple effect for female\nIFG_44.33.7_2_f <- lm(IFG_44.33.7 ~ I(sqrt(income_needs)) * Sex + ICV + Tanner + Age + White, data = roi_inc)\nsummary(IFG_44.33.7_2_f)\nAIC(IFG_44.33.7_2_f)\nBIC(IFG_44.33.7_2_f)\n\ncontrasts(roi_inc$Sex) = c(1, 0) #simple effect for male\nIFG_44.33.7_2_m <- lm(IFG_44.33.7 ~ I(sqrt(income_needs)) * Sex + ICV + Tanner + Age + White, data = roi_inc)\nsummary(IFG_44.33.7_2_m)\n\n#log\nIFG_44.33.7_3 <- lm(IFG_44.33.7 ~ I(log(income_needs)) * Sex + ICV + Tanner + Age + White, data = roi_inc)\nsummary(IFG_44.33.7_3)\nAIC(IFG_44.33.7_3)\nBIC(IFG_44.33.7_3)\n```\n\n```{r IFG_53.26.13_int_income}\n#no interaction\nIFG_53.26.13_0 <- lm(IFG_53.26.13~ income_needs + Sex + ICV + Tanner + Age + White, data = roi_inc)\nsummary(IFG_44.33.7_0)\n\n#linear\nIFG_53.26.13_1 <- lm(IFG_53.26.13~ income_needs * Sex + ICV + Tanner + Age + White, data = roi_inc)\nsummary(IFG_53.26.13_1)\nAIC(IFG_53.26.13_1)\nBIC(IFG_53.26.13_1)\n\n#square-root\ncontrasts(roi_inc$Sex) = c(0, 1) #simple effect for female\nIFG_53.26.13_2_f <- lm(IFG_53.26.13 ~ I(sqrt(income_needs)) * Sex + ICV + Tanner + Age + White, data = roi_inc)\nsummary(IFG_53.26.13_2_f)\nAIC(IFG_53.26.13_2_f)\nBIC(IFG_53.26.13_2_f)\n\ncontrasts(roi_inc$Sex) = c(1, 0) #simple effect for male\nIFG_53.26.13_2_m <- lm(IFG_53.26.13 ~ I(sqrt(income_needs)) * Sex + ICV + Tanner + Age + White, data = roi_inc)\nsummary(IFG_53.26.13_2_m)\n\n#log\nIFG_53.26.13_3 <- lm(IFG_53.26.13 ~ I(log(income_needs)) * Sex + ICV + Tanner + Age + White, data = roi_inc)\nsummary(IFG_53.26.13_3)\nAIC(IFG_53.26.13_3)\nBIC(IFG_53.26.13_3)\n```\n\nCoordinates are -56.27.14. Removed - sign for variable name. \n```{r IFG_56.27.14_int_income}\n#no interaction\nIFG_56.27.14_0 <- lm(IFG_56.27.14 ~ income_needs + Sex + ICV + Tanner + Age + White, data = roi_inc)\nsummary(IFG_56.27.14_0)\n\n#linear\nIFG_56.27.14_1 <- lm(IFG_56.27.14~ income_needs * Sex + ICV + Tanner + Age + White, data = roi_inc)\nsummary(IFG_56.27.14_1)\nAIC(IFG_56.27.14_1)\nBIC(IFG_56.27.14_1)\n\n#square-root\ncontrasts(roi_inc$Sex) = c(0, 1) #simple effect for female\nIFG_56.27.14_2_f <- lm(IFG_56.27.14 ~ I(sqrt(income_needs)) * Sex + ICV + Tanner + Age + White, data = roi_inc)\nsummary(IFG_56.27.14_2_f)\nAIC(IFG_56.27.14_2_f)\nBIC(IFG_56.27.14_2_f)\n\ncontrasts(roi_inc$Sex) = c(1, 0) #simple effect for male\nIFG_56.27.14_2_m <- lm(IFG_56.27.14 ~ I(sqrt(income_needs)) * Sex + ICV + Tanner + Age + White, data = roi_inc)\nsummary(IFG_56.27.14_2_m)\n\n#log\nIFG_56.27.14_3 <- lm(IFG_56.27.14 ~ I(log(income_needs)) * Sex + ICV + Tanner + Age + White, data = roi_inc)\nsummary(IFG_56.27.14_3)\nAIC(IFG_56.27.14_3)\nBIC(IFG_56.27.14_3)\n```\n\nFor IFG (44.33.7_1): increases in income associated with decreases for females; increases in income associated with increases for males.\n\nFor IFG (53.26.13):increases in income associated with increases for females; increases in income associated with decreases for males.\n\nFor IFG (-56.27.14): increases in come associated with increases for females; increases in income associated with decreases for males. \n\n```{r IFG_average}\n#average only IFG_53.26.13 and IFG_56.27.14 given they are correlated\nroi_inc$IFG_av <- (roi_inc$IFG_53.26.13 + roi_inc$IFG_56.27.14)/2\n\n#obtain residuals for plotting\nIFG_av_resid <- lm(IFG_av ~ Sex + ICV + Tanner + Age + White, data = roi_inc)\nroi_inc$IFG_av_resid <- residuals(IFG_av_resid)\n\n#square root\npng(filename=\"~/Desktop/ELS/dep_thrt_TBM/depthrt_sync/plots/incsex_IFG.png\", width = 700, height = 600)\nggplot(roi_inc, aes(x = income_needs, y = IFG_av_resid, group = Sex)) +\n  geom_point(size =2,aes(color = Sex)) +\n  geom_smooth(method = \"lm\", se = FALSE, size =2,  formula = y ~ I(sqrt(x)), aes(color = Sex)) +\n  depthrt_theme +\n  xlab(\"Income-to-Needs\") +\n  ylab(\"Inferior Frontal Gyrus\")\ndev.off()\n\n\n```\n\n\n## Plot Medial Frontal Gyrus\n```{r plot_MFG_39.47.27}\n#obtain residuals for plotting\nMFG_39.47.27_resid <- lm(MFG_39.47.27 ~ Sex + ICV + Tanner + Age + White, data = roi_inc)\nroi_inc$MFG_39.47.27_resid <- residuals(MFG_39.47.27_resid)\n\n#linear\nggplot(roi_inc, aes(x = income_needs, y = MFG_39.47.27_resid, group = Sex)) +\n  geom_point(size =2,aes(color = Sex)) +\n  geom_smooth(method = \"lm\", se = FALSE, size =2,  aes(color = Sex))\n\n#square root\nggplot(roi_inc, aes(x = income_needs, y = MFG_39.47.27_resid, group = Sex)) +\n  geom_point(size =2,aes(color = Sex)) +\n  geom_smooth(method = \"lm\", se = FALSE, size =2,  formula = y ~ I(sqrt(x)), aes(color = Sex))\n\n#log\nggplot(roi_inc, aes(x = income_needs, y = MFG_39.47.27_resid, group = Sex)) +\n  geom_point(size =2,aes(color = Sex)) +\n  geom_smooth(method = \"lm\", se = FALSE, size =2,  formula = y ~ I(log(x)), aes(color = Sex))\n```\n\n```{r plot_MFG_41.32.45}\n#obtain residuals for plotting\nMFG_41.32.45_resid <- lm(MFG_41.32.45 ~ Sex + ICV + Tanner + Age + White, data = roi_inc)\nroi_inc$MFG_41.32.45_resid <- residuals(MFG_41.32.45_resid)\n\n#linear\nroi_inc$MFG_41.32.45_resid\nggplot(roi_inc, aes(x = income_needs, y = MFG_41.32.45_resid, group = Sex)) +\n  geom_point(size =2,aes(color = Sex)) +\n  geom_smooth(method = \"lm\", se = FALSE, size =2,  aes(color = Sex))\n\n#square root\nggplot(roi_inc, aes(x = income_needs, y = MFG_41.32.45_resid, group = Sex)) +\n  geom_point(size =2,aes(color = Sex)) +\n  geom_smooth(method = \"lm\", se = FALSE, size =2,  formula = y ~ I(sqrt(x)), aes(color = Sex))\n\n#log\nggplot(roi_inc, aes(x = income_needs, y = MFG_41.32.45_resid, group = Sex)) +\n  geom_point(size =2,aes(color = Sex)) +\n  geom_smooth(method = \"lm\", se = FALSE, size =2,  formula = y ~ I(log(x)), aes(color = Sex))\n```\n\n## Test Interactions: Medial Frontal Gyrus\n```{r MFG_39.47.27_int_income}\n#no interaction\nMFG_39.47.27_0 <- lm(MFG_39.47.27~ income_needs + Sex + ICV + Tanner + Age + White, data = roi_inc)\nsummary(MFG_39.47.27_0)\n\n#linear\nMFG_39.47.27_1 <- lm(MFG_39.47.27~ income_needs * Sex + ICV + Tanner + Age + White, data = roi_inc)\nsummary(MFG_39.47.27_1)\nAIC(MFG_39.47.27_1)\nBIC(MFG_39.47.27_1)\n\n#square-root\ncontrasts(roi_inc$Sex) = c(0, 1) #simple effect for female\nMFG_39.47.27_2_f <- lm(MFG_39.47.27 ~ I(sqrt(income_needs)) * Sex + ICV + Tanner + Age + White, data = roi_inc)\nsummary(MFG_39.47.27_2_f)\nAIC(MFG_39.47.27_2_f)\nBIC(MFG_39.47.27_2_f)\n\ncontrasts(roi_inc$Sex) = c(1, 0) #simple effect for male\nMFG_39.47.27_2_m <- lm(MFG_39.47.27 ~ I(sqrt(income_needs)) * Sex + ICV + Tanner + Age + White, data = roi_inc)\nsummary(MFG_39.47.27_2_m)\n\n#log\nMFG_39.47.27_3 <- lm(MFG_39.47.27 ~ I(log(income_needs)) * Sex + ICV + Tanner + Age + White, data = roi_inc)\nsummary(MFG_39.47.27_3)\nAIC(MFG_39.47.27_3)\nBIC(MFG_39.47.27_3)\n```\n\n```{r MFG_41.32.45_int_income}\n#no interaction\nMFG_41.32.45_0 <- lm(MFG_41.32.45~ income_needs + Sex + ICV + Tanner + Age + White, data = roi_inc)\nsummary(MFG_41.32.45_0)\n\n#linear\nMFG_41.32.45_1 <- lm(MFG_41.32.45~ income_needs * Sex + ICV + Tanner + Age + White, data = roi_inc)\nsummary(IFG_56.27.14_1)\nAIC(IFG_56.27.14_1)\nBIC(IFG_56.27.14_1)\n\n#square-root\ncontrasts(roi_inc$Sex) = c(0, 1) #simple effect for female\nMFG_41.32.45_2_f <- lm(MFG_41.32.45 ~ I(sqrt(income_needs)) * Sex + ICV + Tanner + Age + White, data = roi_inc)\nsummary(MFG_41.32.45_2_f)\nAIC(MFG_41.32.45_2_f)\nBIC(MFG_41.32.45_2_f)\n\ncontrasts(roi_inc$Sex) = c(1, 0) #simple effect for male\nMFG_41.32.45_2_m <- lm(MFG_41.32.45 ~ I(sqrt(income_needs)) * Sex + ICV + Tanner + Age + White, data = roi_inc)\nsummary(MFG_41.32.45_2_m)\n\n#log\nMFG_41.32.45_3 <- lm(MFG_41.32.45 ~ I(log(income_needs)) * Sex + ICV + Tanner + Age + White, data = roi_inc)\nsummary(MFG_41.32.45_3)\nAIC(MFG_41.32.45_3)\nBIC(MFG_41.32.45_3)\n```\n\nFor both MFG regions, increases in income associated with increases in females; increases in income associated with decreases in males. \n\n## Plot Middle Temporal Gyrus\n\nCoordinates are negative: -62.-9.-28; removed - signs for variable name \n```{r plot_MTG_62.9.28}\n#obtain residuals for plotting\nMTG_62.9.28_resid <- lm(MTG_62.9.28 ~ Sex + ICV + Tanner + Age + White, data = roi_inc)\nroi_inc$MTG_62.9.28_resid <- residuals(MTG_62.9.28_resid)\n\n#linear\nggplot(roi_inc, aes(x = income_needs, y = MTG_62.9.28_resid, group = Sex)) +\n  geom_point(size =2,aes(color = Sex)) +\n  geom_smooth(method = \"lm\", se = FALSE, size =2,  aes(color = Sex))\n\n#square root\njpeg(filename=\"~/Desktop/ELS/dep_thrt_TBM/depthrt_sync/plots/inc_MTG.jpg\", width = 700, height = 600)\nggplot(data=roi_inc, aes(x=income_needs, y=MTG_62.9.28_resid, group = Sex)) +\n  geom_point(size = 4, alpha = 6/10, aes (color= Sex)) +\n  geom_smooth(method = \"lm\", se = T, formula = y ~ sqrt(x), size =3, aes(color = Sex, fill = Sex)) +\n  depthrt_theme +\n  scale_color_manual(values=c(\"goldenrod3\",\"cyan4\")) +\n  scale_fill_manual(values=c(\"darkgoldenrod3\", \"darkcyan\")) +\n  ylab(\"Middle temporal gyrus\") +\n  xlab(\"Income-to-needs\")\n\n#log\nggplot(roi_inc, aes(x = income_needs, y = MTG_62.9.28_resid, group = Sex)) +\n  geom_point(size =2,aes(color = Sex)) +\n  geom_smooth(method = \"lm\", se = FALSE, size =2,  formula = y ~ I(log(x)), aes(color = Sex))\n```\n\n## Test Interactions: Middle Temporal Gyrus\n\nCoordinates are negative: -62.-9.-28; removed - signs for variable name \n```{r MTG_62.9.28_int_income}\n#no interaction\nMTG_62.9.28_0 <- lm(MTG_62.9.28~ income_needs + Sex + ICV + Tanner + Age + White, data = roi_inc)\nsummary(MFG_41.32.45_0)\n\n#linear\nMTG_62.9.28_1 <- lm(MTG_62.9.28~ income_needs * Sex + ICV + Tanner + Age + White, data = roi_inc)\nsummary(MTG_62.9.28_1)\nAIC(MTG_62.9.28_1)\nBIC(MTG_62.9.28_1)\n\n#square-root\ncontrasts(roi_inc$Sex) = c(0, 1) #simple effect for female\nMTG_62.9.28_2_f <- lm(MTG_62.9.28 ~ I(sqrt(income_needs)) * Sex + ICV + Tanner + Age + White, data = roi_inc)\nsummary(MTG_62.9.28_2_f)\nAIC(MTG_62.9.28_2_f)\nBIC(MTG_62.9.28_2_f)\n\ncontrasts(roi_inc$Sex) = c(1, 0) #simple effect for male\nMTG_62.9.28_2_m <- lm(MTG_62.9.28 ~ I(sqrt(income_needs)) * Sex + ICV + Tanner + Age + White, data = roi_inc)\nsummary(MTG_62.9.28_2_m)\n\n#log\nMTG_62.9.28_3 <- lm(MTG_62.9.28 ~ I(log(income_needs)) * Sex + ICV + Tanner + Age + White, data = roi_inc)\nsummary(MTG_62.9.28_3)\nAIC(MTG_62.9.28_3)\nBIC(MTG_62.9.28_3)\n```\n\nFor MTG: increases in income associated with increase in females; increases in income associated with decreases in males. \n\n## Plot Superior Frontal Gyrus\n```{r plot_SFG_29.57.31}\n#obtain residuals for plotting\nSFG_29.57.31_resid <- lm(SFG_29.57.31 ~ Sex + ICV + Tanner + Age + White, data = roi_inc)\nroi_inc$SFG_29.57.31_resid <- residuals(SFG_29.57.31_resid)\n\n#linear\nggplot(roi_inc, aes(x = income_needs, y = SFG_29.57.31_resid, group = Sex)) +\n  geom_point(size =2,aes(color = Sex)) +\n  geom_smooth(method = \"lm\", se = FALSE, size =2,  aes(color = Sex))\n\n#square root\nggplot(roi_inc, aes(x = income_needs, y = SFG_29.57.31_resid, group = Sex)) +\n  geom_point(size =2,aes(color = Sex)) +\n  geom_smooth(method = \"lm\", se = FALSE, size =2,  formula = y ~ I(sqrt(x)), aes(color = Sex))\n\n#log\nggplot(roi_inc, aes(x = income_needs, y = SFG_29.57.31_resid, group = Sex)) +\n  geom_point(size =2,aes(color = Sex)) +\n  geom_smooth(method = \"lm\", se = FALSE, size =2,  formula = y ~ I(log(x)), aes(color = Sex))\n```\n\n```{r plot_SFG_4.53.33}\n#obtain residuals for plotting\nSFG_29.57.31_resid <- lm(SFG_4.53.33 ~ Sex + ICV + Tanner + Age + White, data = roi_inc)\nroi_inc$SFG_29.57.31_resid <- residuals(SFG_29.57.31_resid)\n\n#linear\nggplot(roi_inc, aes(x = income_needs, y = SFG_29.57.31_resid, group = Sex)) +\n  geom_point(size =2,aes(color = Sex)) +\n  geom_smooth(method = \"lm\", se = FALSE, size =2,  aes(color = Sex))\n\n#square root\nggplot(roi_inc, aes(x = income_needs, y = SFG_29.57.31_resid, group = Sex)) +\n  geom_point(size =2,aes(color = Sex)) +\n  geom_smooth(method = \"lm\", se = FALSE, size =2,  formula = y ~ I(sqrt(x)), aes(color = Sex))\n\n#log\nggplot(roi_inc, aes(x = income_needs, y = SFG_29.57.31_resid, group = Sex)) +\n  geom_point(size =2,aes(color = Sex)) +\n  geom_smooth(method = \"lm\", se = FALSE, size =2,  formula = y ~ I(log(x)), aes(color = Sex))\n```\n\n```{r plot_SFG_6.47.48}\n#obtain residuals for plotting\nSFG_29.57.31_resid <- lm(SFG_6.47.48 ~ Sex + ICV + Tanner + Age + White, data = roi_inc)\nroi_inc$SFG_29.57.31_resid <- residuals(SFG_29.57.31_resid)\n\n#linear\nggplot(roi_inc, aes(x = income_needs, y = SFG_29.57.31_resid, group = Sex)) +\n  geom_point(size =2,aes(color = Sex)) +\n  geom_smooth(method = \"lm\", se = FALSE, size =2,  aes(color = Sex))\n\n#square root\nggplot(roi_inc, aes(x = income_needs, y = SFG_29.57.31_resid, group = Sex)) +\n  geom_point(size =2,aes(color = Sex)) +\n  geom_smooth(method = \"lm\", se = FALSE, size =2,  formula = y ~ I(sqrt(x)), aes(color = Sex))\n\n#log\nggplot(roi_inc, aes(x = income_needs, y = SFG_29.57.31_resid, group = Sex)) +\n  geom_point(size =2,aes(color = Sex)) +\n  geom_smooth(method = \"lm\", se = FALSE, size =2,  formula = y ~ I(log(x)), aes(color = Sex))\n```\n\n## Test Interactions: Superior Frontal Gyrus\n```{r SFG_29.57.31_int_income}\n#no interaction\nSFG_29.57.31_0 <- lm(SFG_29.57.31~ income_needs + Sex + ICV + Tanner + Age + White, data = roi_inc)\nsummary(SFG_29.57.31_0)\n\n#linear\nSFG_29.57.31_1 <- lm(SFG_29.57.31~ income_needs * Sex + ICV + Tanner + Age + White, data = roi_inc)\nsummary(SFG_29.57.31_1)\nAIC(SFG_29.57.31_1)\nBIC(SFG_29.57.31_1)\n\n#square-root\ncontrasts(roi_inc$Sex) = c(0, 1) #simple effect for female\nSFG_29.57.31_2_f <- lm(SFG_29.57.31 ~ I(sqrt(income_needs)) * Sex + ICV + Tanner + Age + White, data = roi_inc)\nsummary(SFG_29.57.31_2_f)\nAIC(SFG_29.57.31_2_f)\nBIC(SFG_29.57.31_2_f)\n\ncontrasts(roi_inc$Sex) = c(1, 0) #simple effect for male\nSFG_29.57.31_2_m <- lm(SFG_29.57.31 ~ I(sqrt(income_needs)) * Sex + ICV + Tanner + Age + White, data = roi_inc)\nsummary(SFG_29.57.31_2_m)\n\n#log\nSFG_29.57.31_3 <- lm(SFG_29.57.31 ~ I(log(income_needs)) * Sex + ICV + Tanner + Age + White, data = roi_inc)\nsummary(SFG_29.57.31_3)\nAIC(SFG_29.57.31_3)\nBIC(SFG_29.57.31_3)\n```\n\n```{r SFG_SFG_6.47.48_int_income}\n#no interaction\nSFG_6.47.48_0 <- lm(SFG_6.47.48~ income_needs + Sex + ICV + Tanner + Age + White, data = roi_inc)\nsummary(SFG_6.47.48_0)\n\n#linear\nSFG_6.47.48_1 <- lm(SFG_6.47.48~ income_needs * Sex + ICV + Tanner + Age + White, data = roi_inc)\nsummary(SFG_6.47.48_1)\nAIC(SFG_6.47.48_1)\nBIC(SFG_6.47.48_1)\n\n#square-root\ncontrasts(roi_inc$Sex) = c(0, 1) #simple effect for female\nSFG_6.47.48_2_f <- lm(SFG_6.47.48 ~ I(sqrt(income_needs)) * Sex + ICV + Tanner + Age + White, data = roi_inc)\nsummary(SFG_6.47.48_2_f)\nAIC(SFG_6.47.48_2_f)\nBIC(SFG_6.47.48_2_f)\n\ncontrasts(roi_inc$Sex) = c(1, 0) #simple effect for male\nSFG_6.47.48_2_m <- lm(SFG_6.47.48 ~ I(sqrt(income_needs)) * Sex + ICV + Tanner + Age + White, data = roi_inc)\nsummary(SFG_6.47.48_2_m)\n\n#log\nSFG_6.47.48_3 <- lm(SFG_6.47.48 ~ I(log(income_needs)) * Sex + ICV + Tanner + Age + White, data = roi_inc)\nsummary(SFG_6.47.48_3)\nAIC(SFG_6.47.48_3)\nBIC(SFG_6.47.48_3)\n```\n\n```{r SFG_4.53.33_int_income}\n#no interaction\nSFG_4.53.33_0 <- lm(SFG_4.53.33~ income_needs + Sex + ICV + Tanner + Age + White, data = roi_inc)\nsummary(SFG_4.53.33_0)\n\n#linear\nSFG_4.53.33_1 <- lm(SFG_4.53.33~ income_needs * Sex + ICV + Tanner + Age + White, data = roi_inc)\nsummary(SFG_4.53.33_1)\nAIC(SFG_4.53.33_1)\nBIC(SFG_4.53.33_1)\n\n#square-root\ncontrasts(roi_inc$Sex) = c(0, 1) #simple effect for female\nSFG_4.53.33_2_f <- lm(SFG_4.53.33 ~ I(sqrt(income_needs)) * Sex + ICV + Tanner + Age + White, data = roi_inc)\nsummary(SFG_4.53.33_2_f)\nAIC(SFG_4.53.33_2_f)\nBIC(SFG_4.53.33_2_f)\n\ncontrasts(roi_inc$Sex) = c(1, 0) #simple effect for male\nSFG_4.53.33_2_m <- lm(SFG_4.53.33 ~ I(sqrt(income_needs)) * Sex + ICV + Tanner + Age + White, data = roi_inc)\nsummary(SFG_4.53.33_2_m)\n\n#log\nSFG_4.53.33_3 <- lm(SFG_4.53.33 ~ I(log(income_needs)) * Sex + ICV + Tanner + Age + White, data = roi_inc)\nsummary(SFG_4.53.33_3)\nAIC(SFG_4.53.33_3)\nBIC(SFG_4.53.33_3)\n```\n\n## Make a table of R2 values and export \n```{r r2tbl}\nhead <- c(\"Covariate-Only\", \"Linear Interaction\", \"Square-Root Interaction\",\"Log-Transform Interaction\")\nr2tbl<- matrix(c(summary(inc_hipp0)$r.squared, summary(inc_hipp1)$r.squared, summary(inc_hipp2_f)$r.squared, summary(inc_hipp3)$r.squared, summary(inc_RHipp0)$r.squared, summary(inc_RHipp1)$r.squared, summary(inc_RHipp2_f)$r.squared, summary(inc_RHipp3)$r.squared, summary(inc_CV0)$r.squared, summary(inc_CV1)$r.squared, summary(inc_CV2_f)$r.squared, summary(inc_CV3)$r.squared, summary(inc_MTG0)$r.squared, summary(inc_MTG1)$r.squared, summary(inc_MTG2_f)$r.squared, summary(inc_MTG3)$r.squared, summary(inc_OFC0)$r.squared, summary(inc_OFC1)$r.squared, summary(inc_OFC2_f)$r.squared, summary(inc_OFC3)$r.squared, summary(inc_Thal0)$r.squared, summary(inc_Thal1)$r.squared, summary(inc_Thal2_f)$r.squared, summary(inc_Thal3)$r.squared, summary(inc_RThal0)$r.squared, summary(inc_RThal1)$r.squared, summary(inc_RThal2_f)$r.squared, summary(inc_RThal3)$r.squared, summary(inc_Put0)$r.squared, summary(inc_Put1)$r.squared, summary(inc_Put2_f)$r.squared, summary(inc_Put3)$r.squared, summary(inc_Unc0)$r.squared, summary(inc_Unc1)$r.squared, summary(inc_Unc2_f)$r.squared, summary(inc_Unc3)$r.squared, summary(inc_IFOF0)$r.squared, summary(inc_IFOF1)$r.squared, summary(inc_IFOF2_f)$r.squared, summary(inc_IFOF3)$r.squared), ncol = 4, byrow=TRUE)\ncolnames(r2tbl) <- c(\"Covariate-Only\", \"Linear Interaction\", \"Square-Root Interaction\",\"Log-Transform Interaction\")\nrownames(r2tbl) <- c(\"Left Hippocampus\", \"Right Hippocampus\", \"Cerebellar Vermis\", \"Left Medial Temporal Gyrus\", \"Left Occipital Frontal Cortex\", \"Left Thalamus\", \"Right Putamen\", \"Left Uncinate\", \"Inferior Longitudinal Fasiculus\")\n\n\nwrite.csv(r2tbl, \"/Volumes/mooddata/LucyKing/Dep_Thrt_TBM/r2tbl_income.csv\")\n```\n\n",
    "created" : 1521750633567.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2735462811",
    "id" : "FF32BB68",
    "lastKnownWriteTime" : 1522437831,
    "last_content_update" : 1522437832016,
    "path" : "~/Desktop/ELS/dep_thrt_TBM/depthrt_sync/depthrt_scripts/dep_TBM.Rmd",
    "project_path" : "dep_TBM.Rmd",
    "properties" : {
        "chunk_output_type" : "inline"
    },
    "relative_order" : 2,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_markdown"
}